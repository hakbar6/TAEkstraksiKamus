{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"Y3wWpzb8CSAz"},"outputs":[],"source":["import xml.etree.ElementTree as ET\n","import pandas as pd\n","import numpy as np\n","import re"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YpQsaIpnNKHd","executionInfo":{"status":"ok","timestamp":1682740751897,"user_tz":-420,"elapsed":25153,"user":{"displayName":"Raden Fausta Anugrah Dianparama","userId":"17257992174951473980"}},"outputId":"70eb39c2-a146-42d3-fac3-11a6dbe527ff"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["def getFromXML(root):\n","    char_lst = []\n","    font_lst = []\n","    x1_lst = []\n","    y1_lst = []\n","    x2_lst = []\n","    y2_lst = []\n","    size_lst = []\n","    page_lst = []\n","\n","    kata = []\n","    list_kata = []\n","    idx = 0\n","    for child in root: # mengambil isi karakter dari halaman awal entri hingga halaman akhir entri\n","        idx += 1\n","        for textbox in child.iter('textbox'):\n","            for textline in textbox:\n","                for text in textline:\n","                    if text.text != '' and text.attrib != {}:\n","                        try:\n","                            char_lst.append(text.text)\n","                            font_lst.append(text.attrib[\"font\"])\n","                            bbox = text.attrib[\"bbox\"].split(',')\n","                            x1_lst.append(bbox[0])\n","                            y1_lst.append(bbox[1])\n","                            x2_lst.append(bbox[2])\n","                            y2_lst.append(bbox[3])\n","                            size_lst.append(text.attrib[\"size\"])\n","                            page_lst.append(idx)\n","                        except:\n","                            pass\n","    df = pd.DataFrame()\n","    df['char'] = char_lst\n","    df['font'] = font_lst\n","    df['x1'] = x1_lst\n","    df['y1'] = y1_lst\n","    df['x2'] = x2_lst\n","    df['y2'] = y2_lst\n","    df['size'] = size_lst\n","    df['page'] = page_lst\n","    return df"],"metadata":{"id":"hHUjVQCyjTtK"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def parse(df):\n","    text_lst = []\n","    size_lst = []\n","    font_lst = []\n","    x0_lst = []\n","    y0_lst = []\n","    x1_lst = []\n","    y1_lst = []\n","    page_lst = []\n","\n","    kata = []\n","    list_kata = []\n","    idx = 0\n","\n","    font = ''\n","    text = ''\n","    need_update = 1\n","    for i, row in df.iterrows():\n","        if row['char'] == ' ' or font != row['font'] or page != row['page']:\n","            need_update = 1\n","            if text != '':\n","                text_lst.append(text)\n","                size_lst.append(size)\n","                font_lst.append(font)\n","                x0_lst.append(x0)\n","                y0_lst.append(y0)\n","                x1_lst.append(x1)\n","                y1_lst.append(y1)\n","                page_lst.append(page)\n","\n","            text = ''\n","            if row['char'] == ' ':\n","                continue\n","        if need_update:\n","            x0 = row['x1']\n","            y0 = row['y1']\n","            x1 = row['x2']\n","            y1 = row['y2']\n","            page = row['page']\n","            font = row['font']\n","            size = row['size']\n","        else:\n","            x0 = min(x0, row['x1'])\n","            y0 = min(y0, row['y1'])\n","            x1 = max(x1, row['x2'])\n","            y1 = max(y1, row['y2'])\n","        text += row['char']\n","\n","\n","    df = pd.DataFrame()\n","    df['text'] = text_lst\n","    df['size'] = size_lst\n","    df['font'] = font_lst\n","    df['x0'] = x0_lst\n","    df['y0'] = y0_lst\n","    df['x1'] = x1_lst\n","    df['y1'] = y1_lst\n","    df['page'] = page_lst\n","    return df"],"metadata":{"id":"HzZ5uvBLdyj0"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import os\n","from pathlib import Path\n","directory = \"/content/drive/MyDrive/TA Bareng Bareng/Data/XML Char/\"\n","path = '/content/drive/MyDrive/TA Bareng Bareng/Data/XML Kata/'\n","isExist = os.path.exists(path)\n","if not isExist:\n","    os.makedirs(path)\n","for filename in os.listdir(directory):\n","    if(filename[-3:] == 'csv'):\n","        f = os.path.join(directory, filename)\n","        df = pd.read_csv(f)\n","        hasil = parse(df)\n","        hasil.to_csv(path + filename[:2] + \"_kata.csv\", index = False)\n"],"metadata":{"id":"NlGiAPOWIfpc"},"execution_count":null,"outputs":[]}],"metadata":{"interpreter":{"hash":"31f2aee4e71d21fbe5cf8b01ff0e069b9275f58929596ceb00d14d90e3e16cd6"},"kernelspec":{"display_name":"Python 3.8.2 64-bit","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.2"},"colab":{"provenance":[]}},"nbformat":4,"nbformat_minor":0}